# Bank REST backend

## Что уже подготовлено
- Maven-проект со Spring Boot 3.2.5 и зависимостями для Security, Data JPA, Liquibase, JWT и Swagger.
- Базовый класс `BankRestApplication` и тест, который проверяет, что контекст стартует и подтягивает настройки из `application.yml`.
- Конфигурационные классы для безопасной работы с секретами JWT и ключом шифрования номеров карт.
- Пустые пакеты с README-файлами внутри — сюда нужно положить будущие контроллеры, сервисы, сущности и т.д.

## Подготовка окружения
### Вариант 1. Docker Compose
1. Убедиться, что установлен Docker (и включён Docker Desktop на Windows/Mac).
2. Выполнить в корне проекта:
   ```bash
   docker compose up -d
   ```
3. Контейнер поднимет PostgreSQL на хостовом порту `5433` (проброшен на стандартный `5432` внутри контейнера) и создаст базу `bank_app` вместе с пользователем `bank_user`/`bank_pass`.
4. Если до этого уже поднимался контейнер с другими кредами, выполните `docker compose down -v`, чтобы очистить старый volume и переинициализировать базу.
5. Остановить окружение можно командой:
   ```bash
   docker compose down
   ```

### Вариант 2. Локальная база без Docker
Если PostgreSQL установлен вручную, сначала создайте суперпользователя (или воспользуйтесь существующим), затем создайте пользователя и базу с теми же именами, что в настройках приложения:
```sql
create role bank_user login password 'bank_pass';
create database bank_app owner bank_user;
```

### Переопределение настроек подключения
По умолчанию datasource берёт значения из `application.yml`, но каждое из них можно переопределить переменными окружения:
- `BANK_REST_DB_URL`
- `BANK_REST_DB_USERNAME`
- `BANK_REST_DB_PASSWORD`

По умолчанию URL указывает на `jdbc:postgresql://localhost:5433/bank_app`. Если локальная база слушает другой порт (например, стандартный `5432`), поменяйте URL в `application.yml` или задайте переменную окружения.

Это удобно, если база уже существует или нужно временно подключиться к другой схеме.

## Как запустить приложение
```bash
./mvnw spring-boot:run
```
Либо импортировать проект в IntelliJ IDEA и запустить `BankRestApplication`.

## Следующие шаги по реализации
1. Описать доменные сущности (пользователи, карты, переводы) и миграции Liquibase.
2. Настроить безопасность (JWT, фильтры, `SecurityConfig`).
3. Реализовать сервисный слой, контроллеры и DTO.
4. Написать тесты на ключевые сценарии и оформить документацию OpenAPI.

Документ обновится по мере продвижения разработки.